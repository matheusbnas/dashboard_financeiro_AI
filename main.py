#!/usr/bin/env python3
"""
Dashboard Financeiro Completo v5.0 - Launcher Principal
Sistema completo de an√°lise financeira pessoal com IA integrada

üöÄ ATUALIZA√á√ïES v5.0:
‚úÖ Chatbot IA integrado para an√°lise conversacional
‚úÖ Google Sheets avan√ßado com organiza√ß√£o autom√°tica por ano/m√™s
‚úÖ CSS otimizado para perfeita compatibilidade claro/escuro
‚úÖ Menu de navega√ß√£o unificado no dashboard
‚úÖ Configura√ß√£o autom√°tica completa
‚úÖ Emails atualizados: matheusbnas@gmail.com e dashboard-financeiro@api-financeiro-460817.iam.gserviceaccount.com

Execute: python main.py
"""

import os
import sys
import subprocess
import json
from pathlib import Path
from datetime import datetime
import pandas as pd
import webbrowser
import platform

# Adicionar pasta src ao path para imports
sys.path.insert(0, os.path.join(os.path.dirname(__file__), 'src'))

# ASCII Art atualizado
LOGO = r"""
 $$$$$$\  $$$$$$$\   $$$$$$\   $$$$$$\  $$\   $$\ $$$$$$\ $$\      $$\  $$$$$$\        $$\    $$\ $$$$$$$\  
$$  __$$\ $$  __$$\ $$  __$$\ $$  __$$\ $$ |  $$ |\_$$  _|$$$\    $$$ |$$  __$$\       $$ |   $$ |$$  _____|
$$ /  \__|$$ |  $$ |$$ /  $$ |$$ /  \__|$$ |  $$ |  $$ |  $$$$\  $$$$ |$$ /  $$ |      $$ |   $$ |$$ |      
\$$$$$$\  $$$$$$$  |$$$$$$$$ |\$$$$$$\  $$$$$$$$ |  $$ |  $$\$$\$$ $$ |$$ |  $$ |      \$$\  $$  |$$$$$$$\  
 \____$$\ $$  ____/ $$  __$$ | \____$$\ $$  __$$ |  $$ |  $$ \$$$  $$ |$$ |  $$ |       \$$\$$  / \_____$$\ 
$$\   $$ |$$ |      $$ |  $$ |$$\   $$ |$$ |  $$ |  $$ |  $$ |\$  /$$ |$$ |  $$ |        \$$$  /  $$\   $$ |
\$$$$$$  |$$ |      $$ |  $$ |\$$$$$$  |$$ |  $$ |$$$$$$\ $$ | \_/ $$ | $$$$$$  |         \$  /   \$$$$$$  |
 \______/ \__|      \__|  \__| \______/ \__|  \__|\______|\__|     \__| \______/           \_/     \______/ 
"""

class FinancialDashboardLauncherV5:
    """Launcher principal do sistema v5.0 com todas as melhorias"""
    
    def __init__(self):
        self.config_file = "config.json"
        self.version = "5.0.0"
        
        # M√≥dulos dispon√≠veis (atualizado)
        self.modules = {
            'dashboard': 'dashboard.py',
            'chatbot': 'chatbot.py',
            'categorizer': 'src/llm_categorizer.py',
            'sync_basic': 'src/google_sheets_sync.py',
            'sync_advanced': 'src/google_sheets_advanced.py',
            'analytics': 'src/advanced_analytics.py',
            'auto_setup': 'auto_setup.py',
            'system_check': 'system_checker.py'
        }
        
        # Emails configurados
        self.emails = {
            'primary': 'matheusbnas@gmail.com',
            'service_account': 'dashboard-financeiro@api-financeiro-460817.iam.gserviceaccount.com'
        }
        
        self.config = self.load_config()
        self.data_stats = self.check_data_availability()
        self.system_status = self.check_system_status()
    
    def load_config(self) -> dict:
        """Carrega configura√ß√£o do sistema"""
        default_config = {
            "project_info": {
                "name": "Dashboard Financeiro Avan√ßado",
                "version": self.version,
                "created": datetime.now().isoformat(),
                "last_updated": datetime.now().isoformat()
            },
            "features": {
                "chatbot_enabled": True,
                "google_sheets_advanced": True,
                "ai_categorization": True,
                "nubank_optimized": True,
                "theme_adaptive": True,
                "css_optimized": True
            },
            "first_run": True,
            "google_sheets_configured": False,
            "llm_provider": "groq",
            "data_folders": ["data/raw", "extratos", "."],
            "last_analysis": None,
            "user_preferences": {
                "default_action": "dashboard",
                "auto_categorize": True,
                "auto_sync": False,
                "preferred_llm": "groq"
            },
            "integrations": {
                "google_sheets": {
                    "advanced_mode": True,
                    "auto_organize": True,
                    "create_yearly_summary": True,
                    "auto_share": True
                },
                "ai_services": {
                    "groq_enabled": False,
                    "openai_enabled": False,
                    "chatbot_active": True
                }
            },
            "ui": {
                "theme": "auto",
                "css_optimized": True,
                "navigation_menu": True
            },
            "emails": self.emails
        }
        
        if os.path.exists(self.config_file):
            try:
                with open(self.config_file, 'r', encoding='utf-8') as f:
                    config = json.load(f)
                # Mesclar com defaults para novos campos v5.0
                for key, value in default_config.items():
                    if key not in config:
                        config[key] = value
                
                # Atualizar emails se necess√°rio
                config["emails"] = self.emails
                return config
            except Exception as e:
                print(f"‚ö†Ô∏è Erro ao carregar config: {e}")
                return default_config
        
        return default_config
    
    def save_config(self):
        """Salva configura√ß√£o"""
        try:
            self.config["project_info"]["last_updated"] = datetime.now().isoformat()
            with open(self.config_file, 'w', encoding='utf-8') as f:
                json.dump(self.config, f, ensure_ascii=False, indent=2)
        except Exception as e:
            print(f"‚ö†Ô∏è Erro ao salvar config: {e}")
    
    def check_data_availability(self) -> dict:
        """Verifica disponibilidade de dados"""
        stats = {
            "csv_files": 0,
            "nubank_files": 0,
            "total_transactions": 0,
            "date_range": None,
            "categories_available": False,
            "folders_checked": [],
            "recent_files": []
        }
        
        # Procurar CSVs
        csv_files = []
        nubank_files = []
        
        for folder in self.config["data_folders"]:
            if os.path.exists(folder):
                stats["folders_checked"].append(folder)
                folder_csvs = list(Path(folder).glob("*.csv"))
                csv_files.extend(folder_csvs)
                
                # Identificar arquivos do Nubank
                nubank_pattern = list(Path(folder).glob("Nubank_*.csv"))
                nubank_files.extend(nubank_pattern)
        
        stats["csv_files"] = len(csv_files)
        stats["nubank_files"] = len(nubank_files)
        
        # Arquivos mais recentes
        if csv_files:
            csv_files_with_time = [(f, f.stat().st_mtime) for f in csv_files]
            csv_files_with_time.sort(key=lambda x: x[1], reverse=True)
            stats["recent_files"] = [str(f[0]) for f in csv_files_with_time[:5]]
            
            # Analisar arquivo de exemplo
            try:
                sample_file = csv_files[0]
                sample_df = pd.read_csv(sample_file)
                
                stats["total_transactions"] = len(sample_df)
                stats["categories_available"] = 'Categoria' in sample_df.columns
                
                # Detectar formato e datas
                if all(col in sample_df.columns for col in ['date', 'title', 'amount']):
                    # Formato Nubank
                    sample_df['date'] = pd.to_datetime(sample_df['date'], errors='coerce')
                    stats["date_range"] = {
                        "start": sample_df['date'].min(),
                        "end": sample_df['date'].max()
                    }
                    stats["format"] = "Nubank"
                elif 'Data' in sample_df.columns:
                    # Formato tradicional
                    sample_df['Data'] = pd.to_datetime(sample_df['Data'], errors='coerce')
                    stats["date_range"] = {
                        "start": sample_df['Data'].min(),
                        "end": sample_df['Data'].max()
                    }
                    stats["format"] = "Tradicional"
                
            except Exception as e:
                stats["error"] = str(e)
        
        return stats
    
    def check_system_status(self) -> dict:
        """Verifica status do sistema"""
        status = {
            "modules_available": {},
            "dependencies_ok": True,
            "css_optimized": False,
            "chatbot_ready": False,
            "google_sheets_basic": False,
            "google_sheets_advanced": False,
            "ai_ready": False
        }
        
        # Verificar m√≥dulos
        for module_name, module_path in self.modules.items():
            status["modules_available"][module_name] = os.path.exists(module_path)
        
        # Verificar depend√™ncias cr√≠ticas
        try:
            import streamlit
            import pandas
            import plotly
            status["dependencies_ok"] = True
        except ImportError:
            status["dependencies_ok"] = False
        
        # Verificar CSS otimizado
        css_path = Path("css/dashboard_styles.css")
        if css_path.exists():
            css_content = css_path.read_text(encoding='utf-8')
            status["css_optimized"] = "border-radius" in css_content and "transition" in css_content
        
        # Verificar chatbot
        status["chatbot_ready"] = status["modules_available"].get("chatbot", False)
        
        # Verificar Google Sheets
        creds_exist = os.path.exists("credentials/google_credentials.json")
        basic_module = status["modules_available"].get("sync_basic", False)
        advanced_module = status["modules_available"].get("sync_advanced", False)
        
        status["google_sheets_basic"] = creds_exist and basic_module
        status["google_sheets_advanced"] = creds_exist and advanced_module
        
        # Verificar IA
        env_file = Path(".env")
        if env_file.exists():
            env_content = env_file.read_text(encoding='utf-8')
            has_groq = "GROQ_API_KEY=" in env_content and len(env_content.split("GROQ_API_KEY=")[1].split("\n")[0].strip()) > 0
            has_openai = "OPENAI_API_KEY=" in env_content and len(env_content.split("OPENAI_API_KEY=")[1].split("\n")[0].strip()) > 0
            status["ai_ready"] = has_groq or has_openai
        
        return status
    
    def show_welcome_screen_v5(self):
        """Exibe tela de boas-vindas v5.0"""
        os.system('cls' if os.name == 'nt' else 'clear')
        
        print("\033[96m" + LOGO + "\033[0m")
        print("\033[92m" + "="*100 + "\033[0m")
        print("\033[93m" + "         DASHBOARD FINANCEIRO PESSOAL COMPLETO v5.0".center(100) + "\033[0m")
        print("\033[94m" + "        ü§ñ IA INTEGRADA | ‚òÅÔ∏è GOOGLE SHEETS AVAN√áADO | üí≥ NUBANK OTIMIZADO".center(100) + "\033[0m")
        print("\033[92m" + "="*100 + "\033[0m")
        
        # Emails configurados
        print(f"\nüìß EMAILS CONFIGURADOS:")
        print(f"   ‚Ä¢ Principal: {self.emails['primary']}")
        print(f"   ‚Ä¢ Service Account: {self.emails['service_account']}")
        
        # Novidades v5.0
        print(f"\nüéâ FUNCIONALIDADES v5.0:")
        print(f"   ü§ñ Chatbot IA integrado - Converse sobre seus gastos")
        print(f"   ‚òÅÔ∏è Google Sheets avan√ßado - Planilhas organizadas por ano/m√™s automaticamente")
        print(f"   üé® CSS otimizado v3 - Legibilidade perfeita em todos os temas") 
        print(f"   üß≠ Menu unificado - Navega√ß√£o integrada no dashboard")
        print(f"   üìä Bot√£o direto Google Sheets - Acesso r√°pido √†s planilhas")
        print(f"   üîß Configura√ß√£o autom√°tica - Setup completo em um comando")
        
        # Status do sistema
        print(f"\nüìä STATUS DO SISTEMA:")
        print(f"   ‚Ä¢ Arquivos CSV: {self.data_stats.get('csv_files', 0)} (Nubank: {self.data_stats.get('nubank_files', 0)})")
        print(f"   ‚Ä¢ Transa√ß√µes estimadas: {self.data_stats.get('total_transactions', 0):,}")
        
        if self.data_stats.get('date_range'):
            start = self.data_stats['date_range']['start']
            end = self.data_stats['date_range']['end']
            if pd.notna(start) and pd.notna(end):
                print(f"   ‚Ä¢ Per√≠odo: {start.strftime('%d/%m/%Y')} at√© {end.strftime('%d/%m/%Y')}")
        
        # Status dos m√≥dulos v5.0
        print(f"\nüîß FUNCIONALIDADES v5.0:")
        
        features = [
            ("üìä Dashboard Principal", self.system_status["modules_available"].get('dashboard', False)),
            ("ü§ñ Chatbot IA", self.system_status["chatbot_ready"]),
            ("‚òÅÔ∏è Google Sheets B√°sico", self.system_status["google_sheets_basic"]),
            ("üöÄ Google Sheets Avan√ßado", self.system_status["google_sheets_advanced"]),
            ("üè∑Ô∏è Categoriza√ß√£o IA", self.system_status["modules_available"].get('categorizer', False)),
            ("üìà An√°lise Avan√ßada", self.system_status["modules_available"].get('analytics', False)),
            ("üé® CSS Otimizado v3", self.system_status["css_optimized"]),
            ("üîß Depend√™ncias", self.system_status["dependencies_ok"])
        ]
        
        for feature_name, status in features:
            status_icon = "‚úÖ" if status else "‚ùå"
            print(f"   ‚Ä¢ {feature_name}: {status_icon}")
        
        # Status das integra√ß√µes
        print(f"\nüîß INTEGRA√á√ïES:")
        print(f"   ‚Ä¢ Google Sheets B√°sico: {'‚úÖ Configurado' if self.system_status['google_sheets_basic'] else '‚ùå N√£o configurado'}")
        print(f"   ‚Ä¢ Google Sheets Avan√ßado: {'‚úÖ Configurado' if self.system_status['google_sheets_advanced'] else '‚ùå N√£o configurado'}")
        print(f"   ‚Ä¢ IA (Groq/OpenAI): {'‚úÖ Configurada' if self.system_status['ai_ready'] else '‚ùå N√£o configurada'}")
        
        # Dados Nubank
        if self.data_stats.get('nubank_files', 0) > 0:
            print(f"\nüí≥ DADOS NUBANK DETECTADOS:")
            print(f"   ‚Ä¢ {self.data_stats['nubank_files']} arquivos Nubank_*.csv")
            print(f"   ‚Ä¢ An√°lise otimizada dispon√≠vel")
            print(f"   ‚Ä¢ Chatbot especializado ativo")
            print(f"   ‚Ä¢ Google Sheets autom√°tico com organiza√ß√£o por per√≠odo")
        
        # Configura√ß√£o inicial
        if self.config.get("first_run", True):
            print(f"\nüéØ PRIMEIRA EXECU√á√ÉO DETECTADA:")
            print(f"   Recomendamos executar a configura√ß√£o autom√°tica para otimizar o sistema.")
    
    def show_main_menu_v5(self):
        """Exibe menu principal v5.0"""
        print(f"\n" + "="*80)
        print("MENU PRINCIPAL v5.0 - COMPLETO COM GOOGLE SHEETS AVAN√áADO")
        print("="*80)
        
        options = [
            # Funcionalidades principais
            ("1", "üöÄ Dashboard Interativo Completo", "dashboard", 
             self.system_status["modules_available"].get('dashboard', False)),
            
            ("2", "ü§ñ Chatbot IA Financeiro", "chatbot", 
             self.system_status["chatbot_ready"]),
            
            ("3", "‚òÅÔ∏è Google Sheets B√°sico", "sheets_basic", 
             self.system_status["google_sheets_basic"]),
            
            ("4", "üöÄ Google Sheets Avan√ßado (Ano/M√™s)", "sheets_advanced", 
             self.system_status["google_sheets_advanced"]),
            
            ("5", "üè∑Ô∏è Categorizar com IA", "categorize", 
             self.system_status["modules_available"].get('categorizer', False)),
            
            ("6", "üìà An√°lise Avan√ßada & Relat√≥rios", "analyze", 
             self.system_status["modules_available"].get('analytics', False)),
            
            # Configura√ß√£o e manuten√ß√£o
            ("7", "‚öôÔ∏è Configura√ß√£o Autom√°tica", "auto_setup", 
             self.system_status["modules_available"].get('auto_setup', False)),
            
            ("8", "üîß Configura√ß√µes do Sistema", "config", True),
            
            ("9", "üîç Diagn√≥stico Completo", "system_check", 
             self.system_status["modules_available"].get('system_check', False)),
            
            # Utilit√°rios
            ("10", "üìÅ Gerenciar Dados", "data_manager", True),
            
            ("11", "‚ÑπÔ∏è Ajuda & Documenta√ß√£o", "help", True),
            
            ("0", "‚ùå Sair", "exit", True)
        ]
        
        for num, title, action, enabled in options:
            if not enabled:
                if action in ['categorize', 'analyze']:
                    status = " (‚ùå M√≥dulo n√£o encontrado em src/)"
                elif action == 'chatbot':
                    status = " (‚ùå chatbot.py n√£o encontrado)"
                elif action in ['sheets_basic', 'sheets_advanced']:
                    status = " (‚ùå Google Sheets n√£o configurado)"
                else:
                    status = " (‚ùå N√£o dispon√≠vel)"
            else:
                status = ""
                
            color = "\033[92m" if enabled else "\033[91m"
            print(f"{color}{num:>2}. {title}{status}\033[0m")
        
        print("="*80)
        
        # Sugest√µes baseadas no status
        if self.config.get("first_run", True):
            print("\nüí° PRIMEIRA EXECU√á√ÉO - SUGEST√ïES:")
            print("   1. Execute 'Configura√ß√£o Autom√°tica' para setup completo")
            print("   2. Configure APIs (.env) para IA e Google Sheets")
            print("   3. Adicione dados CSV em data/raw/")
            print("   4. Use o Dashboard Interativo")
        
        if not self.system_status["ai_ready"]:
            print("\nü§ñ CONFIGURE IA (OPCIONAL):")
            print("   ‚Ä¢ Groq (gratuito): https://console.groq.com/")
            print("   ‚Ä¢ OpenAI (pago): https://platform.openai.com/")
            print("   ‚Ä¢ Adicione chaves no arquivo .env")
        
        if not self.system_status["google_sheets_advanced"]:
            print("\nüöÄ CONFIGURE GOOGLE SHEETS AVAN√áADO:")
            print("   ‚Ä¢ Google Cloud Console: APIs & Services")
            print("   ‚Ä¢ Habilite Google Sheets API + Drive API")
            print("   ‚Ä¢ Crie Service Account e baixe JSON")
            print("   ‚Ä¢ Salve em credentials/google_credentials.json")
            print(f"   ‚Ä¢ Emails configurados: {self.emails['primary']}")
            print(f"   ‚Ä¢ Service Account: {self.emails['service_account']}")
        
        while True:
            choice = input(f"\nüìù Escolha uma op√ß√£o (0-11): ").strip()
            
            selected_option = next((opt for opt in options if opt[0] == choice), None)
            if selected_option:
                _, title, action, enabled = selected_option
                if enabled:
                    return action
                else:
                    print("‚ùå Esta funcionalidade n√£o est√° dispon√≠vel!")
                    if action == "chatbot":
                        print("üí° Configure o arquivo chatbot.py na raiz do projeto")
                    elif action in ['categorize', 'analyze']:
                        print("üí° Verifique se os m√≥dulos est√£o na pasta src/")
                    elif action in ["sheets_basic", "sheets_advanced"]:
                        print("üí° Configure Google Sheets API e credenciais")
            else:
                print("‚ö†Ô∏è Op√ß√£o inv√°lida! Digite um n√∫mero de 0 a 11.")
    
    def execute_dashboard(self):
        """Executa dashboard principal"""
        print("\nüöÄ Iniciando Dashboard Interativo v5.0...")
        print("   ‚Ä¢ Interface otimizada com menu de navega√ß√£o")
        print("   ‚Ä¢ CSS v3 com legibilidade perfeita")
        print("   ‚Ä¢ Bot√£o direto para Google Sheets avan√ßado")
        print("   ‚Ä¢ Integra√ß√£o com chatbot e an√°lise avan√ßada")
        
        if not self.system_status["modules_available"].get('dashboard', False):
            print("‚ùå dashboard.py n√£o encontrado!")
            input("Pressione Enter para continuar...")
            return
        
        try:
            subprocess.run([sys.executable, "-m", "streamlit", "run", "dashboard.py"])
        except Exception as e:
            print(f"‚ùå Erro ao executar dashboard: {e}")
            input("Pressione Enter para continuar...")
    
    def execute_chatbot(self):
        """Executa chatbot IA"""
        print("\nü§ñ Iniciando Chatbot IA Financeiro...")
        print("   ‚Ä¢ An√°lise conversacional dos seus gastos")
        print("   ‚Ä¢ Suporte a Groq (gratuito) e OpenAI")
        print("   ‚Ä¢ Respostas inteligentes sobre padr√µes financeiros")
        print("   ‚Ä¢ Integra√ß√£o com dados Nubank")
        
        if not self.system_status["chatbot_ready"]:
            print("‚ùå Chatbot n√£o est√° configurado!")
            print("üí° Verifique se chatbot.py existe na raiz do projeto")
            input("Pressione Enter para continuar...")
            return
        
        try:
            subprocess.run([sys.executable, "-m", "streamlit", "run", "chatbot.py"])
        except Exception as e:
            print(f"‚ùå Erro ao executar chatbot: {e}")
            input("Pressione Enter para continuar...")
    
    def execute_sheets_basic(self):
        """Executa Google Sheets b√°sico"""
        print("\n‚òÅÔ∏è Iniciando Google Sheets B√°sico...")
        print("   ‚Ä¢ Sincroniza√ß√£o simples com planilhas organizadas")
        print("   ‚Ä¢ 5 abas autom√°ticas: Dados, Resumo, Categorias, Fixos, Top Gastos")
        print(f"   ‚Ä¢ Compartilhamento autom√°tico com: {self.emails['primary']}")
        
        if not self.system_status["google_sheets_basic"]:
            print("‚ùå Google Sheets b√°sico n√£o configurado!")
            print("üí° Configure credenciais em credentials/google_credentials.json")
            input("Pressione Enter para continuar...")
            return
        
        basic_module = self.modules.get('sync_basic')
        if not basic_module or not os.path.exists(basic_module):
            print("‚ùå M√≥dulo b√°sico n√£o encontrado!")
            print("üí° Verifique se google_sheets_sync.py est√° em src/")
            input("Pressione Enter para continuar...")
            return
        
        try:
            subprocess.run([sys.executable, basic_module])
        except Exception as e:
            print(f"‚ùå Erro na sincroniza√ß√£o b√°sica: {e}")
            input("Pressione Enter para continuar...")
    
    def execute_sheets_advanced(self):
        """Executa Google Sheets avan√ßado"""
        print("\nüöÄ Iniciando Google Sheets Avan√ßado...")
        print("   ‚Ä¢ Cria√ß√£o autom√°tica de planilhas por ano/m√™s")
        print("   ‚Ä¢ √çndice master com links para todas as planilhas")
        print("   ‚Ä¢ Organiza√ß√£o inteligente dos dados por per√≠odo")
        print("   ‚Ä¢ 5 abas especializadas por m√™s: Resumo, Dados, Categorias, Estabelecimentos, Fixos")
        print(f"   ‚Ä¢ Compartilhamento autom√°tico com emails configurados")
        
        if not self.system_status["google_sheets_advanced"]:
            print("‚ùå Google Sheets avan√ßado n√£o configurado!")
            print("üí° Configure credenciais em credentials/google_credentials.json")
            input("Pressione Enter para continuar...")
            return
        
        advanced_module = self.modules.get('sync_advanced')
        if not advanced_module or not os.path.exists(advanced_module):
            print("‚ùå M√≥dulo avan√ßado n√£o encontrado!")
            print("üí° Verifique se google_sheets_advanced.py est√° em src/")
            input("Pressione Enter para continuar...")
            return
        
        try:
            subprocess.run([sys.executable, advanced_module])
        except Exception as e:
            print(f"‚ùå Erro na sincroniza√ß√£o avan√ßada: {e}")
            input("Pressione Enter para continuar...")
    
    def execute_auto_setup(self):
        """Executa configura√ß√£o autom√°tica"""
        print("\n‚öôÔ∏è Configura√ß√£o Autom√°tica v5.0...")
        print("   ‚Ä¢ Cria estrutura completa do projeto")
        print("   ‚Ä¢ Instala todas as depend√™ncias")
        print("   ‚Ä¢ Configura arquivos de seguran√ßa")
        print("   ‚Ä¢ Otimiza sistema para v5.0")
        print("   ‚Ä¢ Configura emails automaticamente")
        
        auto_setup_file = self.modules.get('auto_setup')
        if not auto_setup_file or not os.path.exists(auto_setup_file):
            print("‚ùå Script de configura√ß√£o n√£o encontrado!")
            print("üí° Certifique-se de ter auto_setup.py na raiz")
            input("Pressione Enter para continuar...")
            return
        
        try:
            subprocess.run([sys.executable, auto_setup_file])
            print("‚úÖ Configura√ß√£o autom√°tica conclu√≠da!")
            print("üîÑ Reiniciando para aplicar mudan√ßas...")
            
            # Recarregar configura√ß√µes
            self.config = self.load_config()
            self.system_status = self.check_system_status()
            
        except Exception as e:
            print(f"‚ùå Erro na configura√ß√£o autom√°tica: {e}")
            input("Pressione Enter para continuar...")
    
    def execute_data_manager(self):
        """Gerenciador de dados"""
        print("\nüìÅ Gerenciador de Dados v5.0")
        print("="*40)
        
        print("1. Ver arquivos CSV dispon√≠veis")
        print("2. Verificar formato dos dados")
        print("3. Limpar dados processados")
        print("4. Backup dos dados")
        print("5. Estat√≠sticas dos dados")
        print("6. Voltar ao menu principal")
        
        choice = input("\nEscolha (1-6): ").strip()
        
        if choice == "1":
            print(f"\nüìÑ ARQUIVOS CSV ENCONTRADOS:")
            if self.data_stats["recent_files"]:
                for i, file in enumerate(self.data_stats["recent_files"], 1):
                    file_path = Path(file)
                    size = file_path.stat().st_size / 1024  # KB
                    modified = datetime.fromtimestamp(file_path.stat().st_mtime)
                    print(f"   {i}. {file_path.name}")
                    print(f"      Tamanho: {size:.1f} KB")
                    print(f"      Modificado: {modified.strftime('%d/%m/%Y %H:%M')}")
                    print()
            else:
                print("   Nenhum arquivo CSV encontrado")
                print("   üí° Coloque arquivos em: data/raw/, extratos/ ou pasta atual")
        
        elif choice == "2":
            print(f"\nüîç FORMATO DOS DADOS:")
            format_type = self.data_stats.get('format', 'Desconhecido')
            print(f"   ‚Ä¢ Formato detectado: {format_type}")
            print(f"   ‚Ä¢ Transa√ß√µes estimadas: {self.data_stats.get('total_transactions', 0):,}")
            print(f"   ‚Ä¢ Categorias dispon√≠veis: {'Sim' if self.data_stats.get('categories_available') else 'N√£o'}")
            
            if format_type == "Nubank":
                print(f"   ‚Ä¢ Otimiza√ß√µes Nubank: ‚úÖ Ativas")
                print(f"   ‚Ä¢ An√°lise de estabelecimentos: ‚úÖ Dispon√≠vel")
                print(f"   ‚Ä¢ Chatbot especializado: ‚úÖ Configurado")
                print(f"   ‚Ä¢ Google Sheets avan√ßado: ‚úÖ Compat√≠vel")
        
        elif choice == "3":
            print(f"\nüßπ Limpeza de dados processados...")
            folders_to_clean = ['data/processed', 'data/exports', 'logs']
            
            for folder in folders_to_clean:
                if os.path.exists(folder):
                    import shutil
                    shutil.rmtree(folder)
                    os.makedirs(folder, exist_ok=True)
                    print(f"   ‚úÖ {folder}/ limpo")
            
            print("‚úÖ Limpeza conclu√≠da!")
        
        elif choice == "5":
            print(f"\nüìä ESTAT√çSTICAS DOS DADOS:")
            print(f"   ‚Ä¢ Total de arquivos CSV: {self.data_stats.get('csv_files', 0)}")
            print(f"   ‚Ä¢ Arquivos Nubank: {self.data_stats.get('nubank_files', 0)}")
            print(f"   ‚Ä¢ Pastas verificadas: {len(self.data_stats.get('folders_checked', []))}")
            
            for folder in self.data_stats.get('folders_checked', []):
                csv_count = len(list(Path(folder).glob("*.csv")))
                print(f"     - {folder}: {csv_count} arquivos")
            
            print(f"   ‚Ä¢ Emails configurados: {len(self.emails)}")
            print(f"     - Principal: {self.emails['primary']}")
            print(f"     - Service Account: {self.emails['service_account']}")
        
        input("\nPressione Enter para continuar...")
    
    def show_help_v5(self):
        """Exibe ajuda atualizada v5.0"""
        print("\nüìñ AJUDA E DOCUMENTA√á√ÉO v5.0")
        print("="*60)
        
        help_sections = [
            ("üöÄ In√≠cio R√°pido v5.0", [
                "1. Execute 'Configura√ß√£o Autom√°tica' (op√ß√£o 7)",
                "2. Configure APIs no arquivo .env (opcional)",
                "3. Adicione dados CSV em data/raw/",
                "4. Use 'Dashboard Interativo' (op√ß√£o 1)",
                "5. Experimente o 'Chatbot IA' (op√ß√£o 2)",
                "6. Crie planilhas com 'Google Sheets Avan√ßado' (op√ß√£o 4)"
            ]),
            
            ("üí≥ Dados Nubank", [
                "üìÑ Formato: date,title,amount",
                "üíæ Salvar como: Nubank_YYYYMMDD.csv",
                "üìÅ Pasta: data/raw/",
                "üîß Processamento autom√°tico otimizado",
                "üè™ An√°lise de estabelecimentos exclusiva",
                "üìä Google Sheets com organiza√ß√£o por per√≠odo"
            ]),
            
            ("ü§ñ Chatbot IA", [
                "üí¨ Converse sobre seus gastos em linguagem natural",
                "üîç Perguntas: 'Quanto gastei?', 'Onde gasto mais?'",
                "üß† IA: Groq (gratuito) ou OpenAI (pago)",
                "‚öôÔ∏è Configure chaves API no arquivo .env",
                "üéØ Insights personalizados baseados nos dados"
            ]),
            
            ("üöÄ Google Sheets Avan√ßado", [
                "üìä Cria√ß√£o autom√°tica de planilhas por ano/m√™s",
                "üìã √çndice master com links para todas as planilhas",
                "üóìÔ∏è Organiza√ß√£o inteligente por per√≠odo",
                "üìà 5 abas especializadas por m√™s",
                "üë• Compartilhamento autom√°tico configurado",
                "üîó Links diretos para acesso r√°pido"
            ]),
            
            ("üé® Interface v5.0", [
                "üß≠ Menu de navega√ß√£o integrado no dashboard",
                "üåì CSS v3 com legibilidade perfeita em qualquer tema",
                "üì± Design responsivo otimizado",
                "‚ö° Performance melhorada",
                "üîó Bot√£o direto para Google Sheets",
                "üéØ UX otimizada para an√°lise financeira"
            ]),
            
            ("üìß Emails Configurados", [
                f"üìß Principal: {self.emails['primary']}",
                f"ü§ñ Service Account: {self.emails['service_account']}",
                "üîß Configura√ß√£o autom√°tica de compartilhamento",
                "‚úÖ Acesso garantido a todas as planilhas",
                "üîí Seguran√ßa e privacidade mantidas"
            ]),
            
            ("üîß Comandos Essenciais", [
                "python main.py - Menu principal completo",
                "streamlit run dashboard.py - Dashboard direto", 
                "streamlit run chatbot.py - Chatbot IA direto",
                "python src/google_sheets_advanced.py - Sheets avan√ßado",
                "python auto_setup.py - Configura√ß√£o autom√°tica",
                "python system_checker.py - Diagn√≥stico"
            ]),
            
            ("üìû Suporte v5.0", [
                f"üìß Email: {self.emails['primary']}",
                f"ü§ñ Service Account: {self.emails['service_account']}",
                "üìÑ Logs: pasta logs/",
                "üîç Diagn√≥stico: python system_checker.py",
                "üìñ Documenta√ß√£o: README.md"
            ])
        ]
        
        for section, items in help_sections:
            print(f"\nüìã {section}:")
            for item in items:
                print(f"   ‚Ä¢ {item}")
        
        print(f"\nüåê LINKS √öTEIS:")
        print(f"   ‚Ä¢ Groq API: https://console.groq.com/")
        print(f"   ‚Ä¢ OpenAI API: https://platform.openai.com/")
        print(f"   ‚Ä¢ Google Cloud: https://console.cloud.google.com/")
        print(f"   ‚Ä¢ Google Sheets: https://docs.google.com/spreadsheets/")
        
        print(f"\nüí° DICAS v5.0:")
        print(f"   ‚Ä¢ Use o bot√£o Google Sheets no dashboard para acesso direto")
        print(f"   ‚Ä¢ Configure IA para categoriza√ß√£o autom√°tica inteligente")
        print(f"   ‚Ä¢ Google Sheets avan√ßado organiza tudo automaticamente")
        print(f"   ‚Ä¢ Chatbot entende linguagem natural sobre finan√ßas")
        print(f"   ‚Ä¢ CSS v3 garante legibilidade perfeita sempre")
        
        input("\nPressione Enter para continuar...")
    
    def execute_config_v5(self):
        """Configura√ß√µes do sistema v5.0"""
        print("\nüîß Configura√ß√µes do Sistema v5.0")
        print("=" * 50)
        
        print("1. ü§ñ Configurar IA (Groq/OpenAI)")
        print("2. ‚òÅÔ∏è Configurar Google Sheets")
        print("3. üé® Configurar Interface")
        print("4. üìÅ Configurar Pastas de Dados")
        print("5. üìß Verificar Emails Configurados")
        print("6. üß™ Testar Conex√µes")
        print("7. üìä Ver Status Completo")
        print("8. üîÑ Resetar Configura√ß√µes")
        print("9. Voltar ao menu principal")
        
        choice = input("\nEscolha (1-9): ").strip()
        
        if choice == "1":
            print("\nü§ñ Configura√ß√£o IA:")
            print("Providers dispon√≠veis:")
            print("1. Groq (Gratuito - Recomendado)")
            print("2. OpenAI (Pago)")
            print("3. Ambos")
            
            ai_choice = input("Escolha (1-3): ").strip()
            
            if ai_choice in ['1', '3']:
                print("\nüîó Groq API:")
                print("1. Acesse: https://console.groq.com/")
                print("2. Crie conta gratuita")
                print("3. Obtenha API Key")
                api_key = input("Cole sua GROQ_API_KEY (ou Enter para pular): ").strip()
                if api_key:
                    print("üí° Adicione ao arquivo .env: GROQ_API_KEY=" + api_key)
            
            if ai_choice in ['2', '3']:
                print("\nüîó OpenAI API:")
                print("1. Acesse: https://platform.openai.com/")
                print("2. Configure billing")
                print("3. Obtenha API Key")
                api_key = input("Cole sua OPENAI_API_KEY (ou Enter para pular): ").strip()
                if api_key:
                    print("üí° Adicione ao arquivo .env: OPENAI_API_KEY=" + api_key)
        
        elif choice == "2":
            print("\n‚òÅÔ∏è Configura√ß√£o Google Sheets:")
            print("Modo avan√ßado v5.0 - Planilhas organizadas automaticamente por ano/m√™s")
            print()
            print("1. Google Cloud Console: https://console.cloud.google.com/")
            print("2. Crie projeto e habilite APIs:")
            print("   ‚Ä¢ Google Sheets API")
            print("   ‚Ä¢ Google Drive API")
            print("3. Crie Service Account")
            print("4. Baixe JSON para credentials/google_credentials.json")
            print()
            print("üìß Emails configurados para compartilhamento autom√°tico:")
            for email in self.emails.values():
                print(f"   ‚Ä¢ {email}")
        
        elif choice == "3":
            print("\nüé® Configura√ß√£o Interface v5.0:")
            print("Funcionalidades:")
            print("   ‚úÖ CSS v3 com legibilidade perfeita")
            print("   ‚úÖ Compatibilidade total com temas claro/escuro")
            print("   ‚úÖ Menu de navega√ß√£o integrado")
            print("   ‚úÖ Bot√£o direto para Google Sheets")
            print("   ‚úÖ Design responsivo")
            print()
            print("N√£o requer configura√ß√£o adicional - ativo automaticamente!")
        
        elif choice == "5":
            print("\nüìß Emails Configurados:")
            print(f"   ‚Ä¢ Principal: {self.emails['primary']}")
            print(f"   ‚Ä¢ Service Account: {self.emails['service_account']}")
            print()
            print("‚úÖ Compartilhamento autom√°tico ativo para:")
            print("   ‚Ä¢ Todas as planilhas Google Sheets")
            print("   ‚Ä¢ Planilhas b√°sicas e avan√ßadas")
            print("   ‚Ä¢ √çndices master por ano")
        
        elif choice == "6":
            print("\nüß™ Testando Conex√µes...")
            
            # Testar depend√™ncias
            print("\nüì¶ Depend√™ncias:")
            deps = ['streamlit', 'pandas', 'plotly', 'gspread']
            for dep in deps:
                try:
                    __import__(dep)
                    print(f"   ‚úÖ {dep}")
                except ImportError:
                    print(f"   ‚ùå {dep}")
            
            # Testar IA
            print("\nü§ñ IA:")
            env_path = Path(".env")
            if env_path.exists():
                env_content = env_path.read_text()
                groq_configured = "GROQ_API_KEY=" in env_content and len(env_content.split("GROQ_API_KEY=")[1].split("\n")[0].strip()) > 0
                openai_configured = "OPENAI_API_KEY=" in env_content and len(env_content.split("OPENAI_API_KEY=")[1].split("\n")[0].strip()) > 0
                
                print(f"   {'‚úÖ' if groq_configured else '‚ùå'} Groq API")
                print(f"   {'‚úÖ' if openai_configured else '‚ùå'} OpenAI API")
            else:
                print("   ‚ùå Arquivo .env n√£o encontrado")
            
            # Testar Google Sheets
            print("\n‚òÅÔ∏è Google Sheets:")
            creds_exist = os.path.exists("credentials/google_credentials.json")
            basic_module = os.path.exists("src/google_sheets_sync.py")
            advanced_module = os.path.exists("src/google_sheets_advanced.py")
            
            print(f"   {'‚úÖ' if creds_exist else '‚ùå'} Credenciais")
            print(f"   {'‚úÖ' if basic_module else '‚ùå'} M√≥dulo B√°sico")
            print(f"   {'‚úÖ' if advanced_module else '‚ùå'} M√≥dulo Avan√ßado")
            
            # Testar dados
            print(f"\nüìä Dados:")
            print(f"   üìÑ CSVs: {self.data_stats['csv_files']}")
            print(f"   üí≥ Nubank: {self.data_stats['nubank_files']}")
        
        elif choice == "7":
            print(f"\nüìä STATUS COMPLETO DO SISTEMA:")
            print(f"   ‚Ä¢ Vers√£o: {self.version}")
            print(f"   ‚Ä¢ Primeira execu√ß√£o: {'Sim' if self.config.get('first_run', True) else 'N√£o'}")
            print(f"   ‚Ä¢ Chatbot: {'‚úÖ' if self.system_status['chatbot_ready'] else '‚ùå'}")
            print(f"   ‚Ä¢ Google Sheets B√°sico: {'‚úÖ' if self.system_status['google_sheets_basic'] else '‚ùå'}")
            print(f"   ‚Ä¢ Google Sheets Avan√ßado: {'‚úÖ' if self.system_status['google_sheets_advanced'] else '‚ùå'}")
            print(f"   ‚Ä¢ IA: {'‚úÖ' if self.system_status['ai_ready'] else '‚ùå'}")
            print(f"   ‚Ä¢ CSS Otimizado v3: {'‚úÖ' if self.system_status['css_optimized'] else '‚ùå'}")
            print(f"   ‚Ä¢ Depend√™ncias: {'‚úÖ' if self.system_status['dependencies_ok'] else '‚ùå'}")
            print(f"   ‚Ä¢ Email Principal: {self.emails['primary']}")
            print(f"   ‚Ä¢ Service Account: {self.emails['service_account']}")
        
        input("\nPressione Enter para continuar...")
    
    def run(self):
        """Executa o launcher principal v5.0"""
        try:
            while True:
                self.show_welcome_screen_v5()
                
                action = self.show_main_menu_v5()
                
                if action == "exit":
                    print("\nüëã Obrigado por usar o Dashboard Financeiro v5.0!")
                    print("üöÄ Agora com Google Sheets avan√ßado e IA integrada!")
                    print("üìß Planilhas compartilhadas automaticamente com seus emails")
                    print("üí° Seus dados est√£o seguros e organizados")
                    break
                elif action == "dashboard":
                    self.execute_dashboard()
                elif action == "chatbot":
                    self.execute_chatbot()
                elif action == "sheets_basic":
                    self.execute_sheets_basic()
                elif action == "sheets_advanced":
                    self.execute_sheets_advanced()
                elif action == "categorize":
                    self.execute_categorization()
                elif action == "analyze":
                    self.execute_analysis()
                elif action == "auto_setup":
                    self.execute_auto_setup()
                elif action == "config":
                    self.execute_config_v5()
                elif action == "system_check":
                    self.execute_system_check()
                elif action == "data_manager":
                    self.execute_data_manager()
                elif action == "help":
                    self.show_help_v5()
                
                # Salvar configura√ß√£o ap√≥s cada a√ß√£o
                self.save_config()
        
        except KeyboardInterrupt:
            print("\n\nüëã Saindo do Dashboard Financeiro v5.0...")
        except Exception as e:
            print(f"\n‚ùå Erro inesperado: {e}")
            print("üí° Execute diagn√≥stico: python system_checker.py")
    
    # M√©todos legados mantidos para compatibilidade
    def execute_categorization(self):
        """Executa categoriza√ß√£o autom√°tica"""
        print("\nü§ñ Iniciando Categoriza√ß√£o Autom√°tica...")
        
        categorizer_file = self.modules['categorizer']
        if not os.path.exists(categorizer_file):
            print(f"‚ùå M√≥dulo n√£o encontrado: {categorizer_file}")
            input("Pressione Enter para continuar...")
            return
        
        try:
            subprocess.run([sys.executable, categorizer_file])
        except Exception as e:
            print(f"‚ùå Erro na categoriza√ß√£o: {e}")
            input("Pressione Enter para continuar...")
    
    def execute_analysis(self):
        """Executa an√°lise avan√ßada"""
        print("\nüìà Iniciando An√°lise Avan√ßada...")
        
        analytics_file = self.modules['analytics']
        if not os.path.exists(analytics_file):
            print(f"‚ùå M√≥dulo n√£o encontrado: {analytics_file}")
            input("Pressione Enter para continuar...")
            return
        
        try:
            subprocess.run([sys.executable, analytics_file])
        except Exception as e:
            print(f"‚ùå Erro na an√°lise: {e}")
            input("Pressione Enter para continuar...")
    
    def execute_system_check(self):
        """Executa diagn√≥stico do sistema"""
        print("\nüîç Diagn√≥stico Completo do Sistema...")
        
        system_check_file = self.modules.get('system_check')
        if not system_check_file or not os.path.exists(system_check_file):
            print("‚ùå Script de diagn√≥stico n√£o encontrado!")
            print("üí° Verifique se system_checker.py est√° na raiz")
            input("Pressione Enter para continuar...")
            return
        
        try:
            subprocess.run([sys.executable, system_check_file])
        except Exception as e:
            print(f"‚ùå Erro no diagn√≥stico: {e}")
            input("Pressione Enter para continuar...")

def main():
    """Fun√ß√£o principal"""
    launcher = FinancialDashboardLauncherV5()
    launcher.run()

if __name__ == "__main__":
    main()

# ===== SCRIPTS DE CONVENI√äNCIA v5.0 =====

def quick_start_v5():
    """In√≠cio r√°pido v5.0"""
    print("‚ö° IN√çCIO R√ÅPIDO v5.0 - GOOGLE SHEETS AVAN√áADO")
    print("Escolha:")
    print("1. üöÄ Dashboard Completo")
    print("2. ü§ñ Chatbot IA")  
    print("3. ‚òÅÔ∏è Google Sheets B√°sico")
    print("4. üöÄ Google Sheets Avan√ßado (Recomendado)")
    print("5. ‚öôÔ∏è Configura√ß√£o Autom√°tica")
    
    choice = input("Op√ß√£o: ").strip()
    
    if choice == "1":
        if os.path.exists("dashboard.py"):
            subprocess.run([sys.executable, "-m", "streamlit", "run", "dashboard.py"])
        else:
            print("‚ùå dashboard.py n√£o encontrado")
    elif choice == "2":
        if os.path.exists("chatbot.py"):
            subprocess.run([sys.executable, "-m", "streamlit", "run", "chatbot.py"])
        else:
            print("‚ùå chatbot.py n√£o encontrado")
    elif choice == "3":
        if os.path.exists("src/google_sheets_sync.py"):
            subprocess.run([sys.executable, "src/google_sheets_sync.py"])
        else:
            print("‚ùå src/google_sheets_sync.py n√£o encontrado")
    elif choice == "4":
        if os.path.exists("src/google_sheets_advanced.py"):
            subprocess.run([sys.executable, "src/google_sheets_advanced.py"])
        else:
            print("‚ùå src/google_sheets_advanced.py n√£o encontrado")
    elif choice == "5":
        if os.path.exists("auto_setup.py"):
            subprocess.run([sys.executable, "auto_setup.py"])
        else:
            print("‚ùå auto_setup.py n√£o encontrado")

def check_system_v5():
    """Verifica√ß√£o r√°pida v5.0"""
    print("üîç VERIFICA√á√ÉO R√ÅPIDA v5.0")
    print("="*40)
    
    # Arquivos v5.0
    v5_files = {
        "üìÑ Principal": ["main.py", "dashboard.py", "chatbot.py"],
        "üìÅ M√≥dulos B√°sicos": ["src/llm_categorizer.py", "src/google_sheets_sync.py", "src/advanced_analytics.py"],
        "üöÄ M√≥dulos Avan√ßados": ["src/google_sheets_advanced.py"],
        "‚öôÔ∏è Config": ["auto_setup.py", "system_checker.py", "requirements.txt"],
        "üé® Interface": ["css/dashboard_styles.css"]
    }
    
    for category, files in v5_files.items():
        print(f"\n{category}:")
        for file in files:
            status = "‚úÖ" if os.path.exists(file) else "‚ùå"
            print(f"   {status} {file}")
    
    # Funcionalidades v5.0
    print(f"\nüöÄ FUNCIONALIDADES v5.0:")
    
    # Chatbot
    chatbot_ready = os.path.exists("chatbot.py")
    print(f"   ü§ñ Chatbot IA: {'‚úÖ' if chatbot_ready else '‚ùå'}")
    
    # Google Sheets b√°sico
    sheets_basic = os.path.exists("src/google_sheets_sync.py") and os.path.exists("credentials/google_credentials.json")
    print(f"   ‚òÅÔ∏è Google Sheets B√°sico: {'‚úÖ' if sheets_basic else '‚ùå'}")
    
    # Google Sheets avan√ßado
    sheets_advanced = os.path.exists("src/google_sheets_advanced.py") and os.path.exists("credentials/google_credentials.json")
    print(f"   üöÄ Google Sheets Avan√ßado: {'‚úÖ' if sheets_advanced else '‚ùå'}")
    
    # CSS otimizado
    css_optimized = False
    if os.path.exists("css/dashboard_styles.css"):
        with open("css/dashboard_styles.css", 'r', encoding='utf-8') as f:
            css_content = f.read()
            css_optimized = "border-radius" in css_content and "transition" in css_content
    print(f"   üé® CSS Otimizado v3: {'‚úÖ' if css_optimized else '‚ùå'}")
    
    # IA configurada
    ai_ready = False
    if os.path.exists(".env"):
        with open(".env", 'r', encoding='utf-8') as f:
            env_content = f.read()
            ai_ready = ("GROQ_API_KEY=" in env_content and len(env_content.split("GROQ_API_KEY=")[1].split("\n")[0].strip()) > 0) or \
                      ("OPENAI_API_KEY=" in env_content and len(env_content.split("OPENAI_API_KEY=")[1].split("\n")[0].strip()) > 0)
    print(f"   üß† IA Configurada: {'‚úÖ' if ai_ready else '‚ùå'}")
    
    # Emails
    print(f"\nüìß EMAILS CONFIGURADOS:")
    print(f"   ‚Ä¢ Principal: matheusbnas@gmail.com")
    print(f"   ‚Ä¢ Service Account: dashboard-financeiro@api-financeiro-460817.iam.gserviceaccount.com")

# Para execu√ß√£o direta com par√¢metros v5.0
if len(sys.argv) > 1:
    command = sys.argv[1].lower()
    
    if command == "quick":
        quick_start_v5()
    elif command == "check":
        check_system_v5()
    elif command == "dashboard":
        if os.path.exists("dashboard.py"):
            subprocess.run([sys.executable, "-m", "streamlit", "run", "dashboard.py"])
    elif command == "chatbot":
        if os.path.exists("chatbot.py"):
            subprocess.run([sys.executable, "-m", "streamlit", "run", "chatbot.py"])
    elif command == "sheets":
        if os.path.exists("src/google_sheets_advanced.py"):
            subprocess.run([sys.executable, "src/google_sheets_advanced.py"])
        elif os.path.exists("src/google_sheets_sync.py"):
            subprocess.run([sys.executable, "src/google_sheets_sync.py"])
    elif command == "setup":
        if os.path.exists("auto_setup.py"):
            subprocess.run([sys.executable, "auto_setup.py"])
    else:
        print(f"Comando desconhecido: {command}")
        print("Comandos v5.0: quick, check, dashboard, chatbot, sheets, setup")
else:
    main()